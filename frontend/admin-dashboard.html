<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- App Styles -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Charts (Admin analytics will use this) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div id="navbar-placeholder"></div>

<div class="dashboard-container pt-4">

    <!-- HEADER: Title + Profile Widget -->
    <div class="d-flex justify-content-between align-items-center mb-5 border-bottom pb-3">
        <div>
            <h2 class="fw-bold mb-0">Admin Dashboard</h2>
            <p class="text-muted small mb-0">System Overview & Management</p>
        </div>

        <!-- Profile Widget -->
        <a href="profile.html" class="text-decoration-none text-dark">
            <div class="profile-section d-flex align-items-center gap-3 p-2 rounded bg-white border">
                <div class="text-end d-none d-md-block">
                    <h6 class="mb-0 fw-bold" id="headerName">Loading...</h6>
                    <span class="badge bg-dark">Admin</span>
                </div>
                <img
                    id="headerAvatar"
                    src="https://via.placeholder.com/150"
                    alt="Profile"
                    class="header-avatar shadow-sm"
                >
            </div>
        </a>
    </div>

    <!-- NAV TABS -->
    <ul class="nav nav-pills mb-4 p-2 bg-light rounded" id="adminTabs" role="tablist">
        <li class="nav-item">
            <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#tab-analytics">
                Analytics
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-users">
                Users
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-classes">
                Classes
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-reports">
                Reports
            </button>
        </li>
    </ul>

    <!-- TAB CONTENT -->
    <div class="tab-content">

        <!-- TAB 1: ANALYTICS -->
        <div class="tab-pane fade show active" id="tab-analytics">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="custom-card card p-4 h-100">
                        <h5 class="text-muted mb-3">Total Users</h5>
                        <h2 class="fw-bold" id="statUsers">â€“</h2>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="custom-card card p-4 h-100">
                        <h5 class="text-muted mb-3">Total Classes</h5>
                        <h2 class="fw-bold" id="statClasses">â€“</h2>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="custom-card card p-4 h-100">
                        <h5 class="text-muted mb-3">Total Sessions</h5>
                        <h2 class="fw-bold" id="statSessions">â€“</h2>
                    </div>
                </div>
            </div>

            <div class="custom-card card p-4">
                <h4 class="mb-3">System Activity</h4>
                <div style="height: 300px;">
                    <canvas id="adminActivityChart"></canvas>
                </div>
            </div>
        </div>

        <!-- TAB 2: USERS -->
        <div class="tab-pane fade" id="tab-users">
            <div class="custom-card card p-4">
                <h3 class="mb-3">Manage Users</h3>
                <p class="text-muted small">
                    View and manage all system users.
                </p>
                <input
                    id="userSearch"
                    class="form-control mb-3"
                    placeholder="Search users by name, email, or role..."
                >
                <div id="usersAlert" class="alert d-none mb-3"></div>
                <div id="usersTable">
                    <!-- populated by admin.js -->
                </div>
            </div>
        </div>

        <!-- TAB 3: CLASSES -->
        <div class="tab-pane fade" id="tab-classes">
            <div class="custom-card card p-4">
                <h3 class="mb-3">Manage Classes</h3>
                <input
                    id="classSearch"
                    class="form-control mb-3"
                    placeholder="Search by code, class name, or teacher..."
                >
                <div id="classesAlert" class="alert d-none mb-3"></div>
                <div id="classesTable" class="scrollable-list">
                    Loading classes...
                </div>
            </div>
        </div>

        <!-- TAB: REPORTS -->
        <div class="tab-pane fade" id="tab-reports">
            <div class="custom-card card">
                <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Attendance Reports</h3>
                <button id="exportBtn" class="btn btn-dark d-none">
                    ðŸ“¥ Export CSV
                </button>
                </div>

                <div class="row">
                <!-- Teacher -->
                <div class="col-md-4 mb-3">
                    <label class="form-label">1. Select Teacher</label>
                    <select id="reportTeacherSelect" class="form-select">
                    <option value="">-- Select Teacher --</option>
                    </select>
                </div>

                <!-- Class -->
                <div class="col-md-4 mb-3 d-none" id="reportClassDiv">
                    <label class="form-label">2. Select Class</label>
                    <select id="reportClassSelect" class="form-select"></select>
                </div>

                <!-- Session -->
                <div class="col-md-4 mb-3 d-none" id="reportSessionDiv">
                    <label class="form-label">3. Select Session</label>
                    <select id="reportSessionSelect" class="form-select"></select>
                </div>
                </div>

                <div id="attendanceListDiv" class="mt-3"></div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="js/config.js"></script>
<script src="js/admin.js"></script>

<!-- admin.js will be added in Option B -->

<!-- Profile header hydration (same pattern as teacher) -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const user = Auth.getUser();
        if (user) {
            document.getElementById("headerName").textContent = user.name;
            if (user.profileImage) {
                document.getElementById("headerAvatar").src = user.profileImage;
            }
        }
    });
</script>

</body>
</html>
